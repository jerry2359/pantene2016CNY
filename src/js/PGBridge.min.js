!function(a,b){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return b(a)}):b(a,!0)}(this,function(a,b){function c(b,c,d){a.WeixinJSBridge?WeixinJSBridge.invoke(b,e(c),function(a){f(b,a,d)}):i(b,d)}function d(b,c,d){a.WeixinJSBridge?WeixinJSBridge.on(b,function(a){d&&d.trigger&&d.trigger(a),f(b,a,c)}):d?i(b,d):i(b,c)}function e(a){return a=a||{},a.appId=x.appId,a.verifyAppId=x.appId,a.verifySignType="sha1",a.verifyTimestamp=x.timestamp+"",a.verifyNonceStr=x.nonceStr,a.verifySignature=x.signature,a}function f(a,b,c){var d,e;switch(delete b.err_code,delete b.err_desc,delete b.err_detail,d=b.errMsg,d||(d=b.err_msg,delete b.err_msg,d=g(a,d,c),b.errMsg=d),c=c||{},c._complete&&(c._complete(b),delete c._complete),d=b.errMsg||"",x.debug&&!c.isInnerInvoke&&alert(JSON.stringify(b)),e=d.indexOf(":"),d.substring(e+1)){case"ok":c.success&&c.success(b);break;case"cancel":c.cancel&&c.cancel(b);break;default:c.fail&&c.fail(b)}c.complete&&c.complete(b)}function g(a,b){var c,d,e;if(b){switch(c=b.indexOf(":"),a){case m.config:d="config";break;case m.openProductSpecificView:d="openProductSpecificView";break;default:d=b.substring(0,c),d=d.replace(/_/g," "),d=d.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}),d=d.substring(0,1).toLowerCase()+d.substring(1),d=d.replace(/ /g,""),-1!=d.indexOf("Wcpay")&&(d=d.replace("Wcpay","WCPay")),(e=n[d])&&(d=e)}c=b.substring(c+1),"confirm"==c&&(c="ok"),"failed"==c&&(c="fail"),-1!=c.indexOf("failed_")&&(c=c.substring(7)),-1!=c.indexOf("fail_")&&(c=c.substring(5)),c=c.replace(/_/g," "),c=c.toLowerCase(),"access denied"!=c&&"no permission to execute"!=c||(c="permission denied"),"config"==d&&"function not exist"==c&&(c="ok"),b=d+":"+c}return b}function h(a){var b,c,d;if(a){for(b=0,c=a.length;c>b;++b)d=a[b],(d=m[d])&&(a[b]=d);return a}}function i(a,b){if(x.debug&&!b.isInnerInvoke){var c=n[a];c&&(a=c),b&&b._complete&&delete b._complete,console.log('"'+a+'",',b||"")}}function j(){if(!("6.0.2">u||0>w.systemType)){var a=new Image;w.appId=x.appId,w.initTime=v.initEndTime-v.initStartTime,w.preVerifyTime=v.preVerifyEndTime-v.preVerifyStartTime,A.getNetworkType({isInnerInvoke:!0,success:function(b){w.networkType=b.networkType,a.src="https://open.weixin.qq.com/sdk/report?v="+w.version+"&o="+w.isPreVerifyOk+"&s="+w.systemType+"&c="+w.clientVersion+"&a="+w.appId+"&n="+w.networkType+"&i="+w.initTime+"&p="+w.preVerifyTime+"&u="+w.url}})}}function k(b){r&&(a.WeixinJSBridge?b():o.addEventListener&&o.addEventListener("WeixinJSBridgeReady",b,!1))}function l(){A.invoke||(A.invoke=function(b,c,d){a.WeixinJSBridge&&WeixinJSBridge.invoke(b,e(c),d)},A.on=function(b,c){a.WeixinJSBridge&&WeixinJSBridge.on(b,c)})}var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;return a.jWeixin?void 0:(m={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest"},n=function(){var a,b={};for(a in m)b[m[a]]=a;return b}(),o=a.document,p=o.title,q=navigator.userAgent.toLowerCase(),r=-1!=q.indexOf("micromessenger"),s=-1!=q.indexOf("android"),t=-1!=q.indexOf("iphone")||-1!=q.indexOf("ipad"),u=function(){var a=q.match(/micromessenger\/(\d+\.\d+\.\d+)/)||q.match(/micromessenger\/(\d+\.\d+)/);return a?a[1]:""}(),v={initStartTime:(new Date).getTime(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},w={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:t?1:s?2:-1,clientVersion:u,url:encodeURIComponent(location.href)},x={},y={_completes:[]},z={state:0,res:{}},k(function(){v.initEndTime=(new Date).getTime()}),A={config:function(a){x=a,i("config",a);var b=!1===x.check?!1:!0;k(function(){var a,d,e;if(b)c(m.config,{verifyJsApiList:h(x.jsApiList)},function(){y._complete=function(a){v.preVerifyEndTime=(new Date).getTime(),z.state=1,z.res=a},y.success=function(){w.isPreVerifyOk=0},y.fail=function(a){y._fail?y._fail(a):z.state=-1};var a=y._completes;return a.push(function(){x.debug||j()}),y.complete=function(){for(var b=0,c=a.length;c>b;++b)a[b]();y._completes=[]},y}()),v.preVerifyStartTime=(new Date).getTime();else{for(z.state=1,a=y._completes,d=0,e=a.length;e>d;++d)a[d]();y._completes=[]}}),x.beta&&l()},ready:function(a){0!=z.state?a():(y._completes.push(a),!r&&x.debug&&a())},error:function(a){"6.0.2">u||(-1==z.state?a(z.res):y._fail=a)},checkJsApi:function(a){c("checkJsApi",{jsApiList:h(a.jsApiList)},function(){return a._complete=function(a){var b,c;s&&(b=a.checkResult,b&&(a.checkResult=JSON.parse(b))),b=a.checkResult;for(c in b)(a=n[c])&&(b[a]=b[c],delete b[c])},a}())},onMenuShareTimeline:function(a){d(m.onMenuShareTimeline,{complete:function(){c("shareTimeline",{title:a.title||p,desc:a.title||p,img_url:a.imgUrl||"",link:a.link||location.href},a)}},a)},onMenuShareAppMessage:function(a){d(m.onMenuShareAppMessage,{complete:function(){c("sendAppMessage",{title:a.title||p,desc:a.desc||"",link:a.link||location.href,img_url:a.imgUrl||"",type:a.type||"link",data_url:a.dataUrl||""},a)}},a)},onMenuShareQQ:function(a){d(m.onMenuShareQQ,{complete:function(){c("shareQQ",{title:a.title||p,desc:a.desc||"",img_url:a.imgUrl||"",link:a.link||location.href},a)}},a)},onMenuShareWeibo:function(a){d(m.onMenuShareWeibo,{complete:function(){c("shareWeiboApp",{title:a.title||p,desc:a.desc||"",img_url:a.imgUrl||"",link:a.link||location.href},a)}},a)},onMenuShareQZone:function(a){d(m.onMenuShareQZone,{complete:function(){c("shareQZone",{title:a.title||p,desc:a.desc||"",img_url:a.imgUrl||"",link:a.link||location.href},a)}},a)},startRecord:function(a){c("startRecord",{},a)},stopRecord:function(a){c("stopRecord",{},a)},onVoiceRecordEnd:function(a){d("onVoiceRecordEnd",a)},playVoice:function(a){c("playVoice",{localId:a.localId},a)},pauseVoice:function(a){c("pauseVoice",{localId:a.localId},a)},stopVoice:function(a){c("stopVoice",{localId:a.localId},a)},onVoicePlayEnd:function(a){d("onVoicePlayEnd",a)},uploadVoice:function(a){c("uploadVoice",{localId:a.localId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},downloadVoice:function(a){c("downloadVoice",{serverId:a.serverId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},translateVoice:function(a){c("translateVoice",{localId:a.localId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},chooseImage:function(a){c("chooseImage",{scene:"1|2",count:a.count||9,sizeType:a.sizeType||["original","compressed"]},function(){return a._complete=function(a){if(s){var b=a.localIds;b&&(a.localIds=JSON.parse(b))}},a}())},previewImage:function(a){c(m.previewImage,{current:a.current,urls:a.urls},a)},uploadImage:function(a){c("uploadImage",{localId:a.localId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},downloadImage:function(a){c("downloadImage",{serverId:a.serverId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},getNetworkType:function(a){c("getNetworkType",{},function(){return a._complete=function(a){var b,c,d=a.errMsg;if(a.errMsg="getNetworkType:ok",b=a.subtype,delete a.subtype,b)a.networkType=b;else switch(c=d.indexOf(":"),b=d.substring(c+1)){case"wifi":case"edge":case"wwan":a.networkType=b;break;default:a.errMsg="getNetworkType:fail"}},a}())},openLocation:function(a){c("openLocation",{latitude:a.latitude,longitude:a.longitude,name:a.name||"",address:a.address||"",scale:a.scale||28,infoUrl:a.infoUrl||""},a)},getLocation:function(a){a=a||{},c(m.getLocation,{type:a.type||"wgs84"},function(){return a._complete=function(a){delete a.type},a}())},hideOptionMenu:function(a){c("hideOptionMenu",{},a)},showOptionMenu:function(a){c("showOptionMenu",{},a)},closeWindow:function(a){a=a||{},c("closeWindow",{immediate_close:a.immediateClose||0},a)},hideMenuItems:function(a){c("hideMenuItems",{menuList:a.menuList},a)},showMenuItems:function(a){c("showMenuItems",{menuList:a.menuList},a)},hideAllNonBaseMenuItem:function(a){c("hideAllNonBaseMenuItem",{},a)},showAllNonBaseMenuItem:function(a){c("showAllNonBaseMenuItem",{},a)},scanQRCode:function(a){a=a||{},c("scanQRCode",{needResult:a.needResult||0,scanType:a.scanType||["qrCode","barCode"]},function(){return a._complete=function(a){var b,c;t&&(b=a.resultStr,b&&(c=JSON.parse(b),a.resultStr=c&&c.scan_code&&c.scan_code.scan_result))},a}())},openProductSpecificView:function(a){c(m.openProductSpecificView,{pid:a.productId,view_type:a.viewType||0},a)},addCard:function(a){var b,d,e,f=a.cardList,g=[];for(b=0,d=f.length;d>b;++b)e=f[b],e={card_id:e.cardId,card_ext:e.cardExt},g.push(e);c(m.addCard,{card_list:g},function(){return a._complete=function(a){var b,c,d,e=a.card_list;if(e){for(e=JSON.parse(e),b=0,c=e.length;c>b;++b)d=e[b],d.cardId=d.card_id,d.cardExt=d.card_ext,d.isSuccess=d.is_succ?!0:!1,delete d.card_id,delete d.card_ext,delete d.is_succ;a.cardList=e,delete a.card_list}},a}())},chooseCard:function(a){c("chooseCard",{app_id:x.appId,location_id:a.shopId||"",sign_type:a.signType||"SHA1",card_id:a.cardId||"",card_type:a.cardType||"",card_sign:a.cardSign,time_stamp:a.timestamp+"",nonce_str:a.nonceStr},function(){return a._complete=function(a){a.cardList=a.choose_card_info,delete a.choose_card_info},a}())},openCard:function(a){var b,d,e,f=a.cardList,g=[];for(b=0,d=f.length;d>b;++b)e=f[b],e={card_id:e.cardId,code:e.code},g.push(e);c(m.openCard,{card_list:g},a)},chooseWXPay:function(a){c(m.chooseWXPay,{timeStamp:a.timestamp+"",nonceStr:a.nonceStr,"package":a.package,paySign:a.paySign,signType:a.signType||"SHA1"},a)}},b&&(a.wx=a.jWeixin=A),A)}),function(){function a(a){return a=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(a),null!=a?decodeURIComponent(a[2]):null}window.PGNative={debug:!0,JsSDKversion:"0.0.1",deviceId:a("deviceId"),locale:a("locale"),platform:a("platform"),channel:a("channel"),appversion:a("appversion"),appname:a("appname"),geoinfo:a("geoinfo")};var b,c,d={},e={},f={};document.addEventListener("PGJsSDK",function(a){console.log("PGJsSDK init success"),b=a.bridge,c=a.priviteKey},!1),PGNative.ready=function(a){try{b.init(d,function(a,b){b&&b(ret)})}catch(c){throw Error("PG init fail")}finally{a&&a(d)}},d.checkJsApi=function(a,c){if(a.jsApiList){if(0>=a.jsApiList.length)throw Error("checkJsApi list is empty!");for(var d=!1,e=0;e<a.jsApiList;e++)"shareUrl"==a.jsApiList[e]&&(d=!0);d||a.jsApiList.push("shareUrl"),b.callHandler("checkJsApi",a,function(a){c(a)})}},d.prompt=function(a,c){console.log("callHandler prompt"),b.callHandler("prompt",a,function(a){c(a)})},d.chooseImage=function(a,c){console.log("callHandler chooseImage"),b.callHandler("chooseImage",a,function(a){c(a)})},d.downloadImage=function(a,c){console.log("callHandler downloadImage"),b.callHandler("downloadImage",a,function(a){c(a)})},d.saveImage=function(a,c){console.log("callHandler saveImage"),b.callHandler("saveImage",a,function(a){c(a)})},d.uploadImage=function(a,c){console.log("callHandler uploadImage"),b.callHandler("uploadImage",a,function(a){c(a)})},d.showMenuItems=function(a,c){console.log("callHandler showMenuItems"),b.callHandler("showMenuItems",a,function(a){c(a)})},d.shareImage=function(a,c){console.log("callHandler shareImage"),b.callHandler("shareImage",a,function(a){c(a)})},d.onWebShareDefault=function(a){if(console.log("call onWebShareDefault"),!(a instanceof Object))throw Error("onWebShareDefault: param must instanceof Object");for(var b in a)e[b]=a[b]},d.onWebShareTimeline=function(a){if(console.log("call onWebShareTimeline"),!(a instanceof Object))throw Error("onWebShareTimeline: param must instanceof Object");for(var b in a)f[b]=a[b]},d._invokeWebShare=function(a){if(console.log("native call _invokeWebShare"),this!==c)throw Error("warning: call this private method is not allowed!");var d="wechatMoments"==a?f:e;b.callHandler("shareUrl",{channel:a,shareData:d},function(){d.callback&&d.callback()})}}(),function(){function a(a){k=a.createElement("iframe"),k.style.display="none",k.src="wvjbscheme://__WVJB_QUEUE_MESSAGE__",a.documentElement.appendChild(k)}function b(a,b){var c,d;if(q=a,WebViewJavascriptBridge._messageHandler)throw Error("PGBridge.init called twice");for(WebViewJavascriptBridge._messageHandler=b,c=m,m=null,d=0;d<c.length;d++)h(c[d])}function c(a,b){console.log("PGJsSDK call _send"),f({data:a},b)}function d(a,b){console.log("PGJsSDK call registerHandler"),n[a]=b}function e(a,b,c){console.log("PGJsSDK call callHandler"),f({handlerName:a,data:b},c)}function f(a,b){if(console.log("PGJsSDK call _doSend"),b){var c="cb_"+p++ +"_"+(new Date).getTime();o[c]=b,a.callbackId=c}if(l.push(a),j.versions.android){if(!window.PinguoNativeAdr)throw Error("Can not find PinguoNativeAdr in android");window.PinguoNativeAdr.sendSignalToAdr()}else j.versions.ios&&(k.src="wvjbscheme://__WVJB_QUEUE_MESSAGE__")}function g(){console.log("PGJsSDK call _fetchQueue");var a=JSON.stringify(l);return l=[],j.versions.android?(window.PinguoNativeAdr.setQueue(a),void 0):a}function h(a){console.log("PGJsSDK call _dispatchMessageFromObjC"),setTimeout(function(){var c,d,e,b=JSON.parse(a);if(b.responseId)c=o[b.responseId],c&&(c(b.responseData),delete o[b.responseId]);else{b.callbackId&&(d=b.callbackId,c=function(a){f({responseId:d,responseData:a})}),e=WebViewJavascriptBridge._messageHandler,b.handlerName&&(e=n[b.handlerName]);try{e(b.data,c)}catch(g){"undefined"!=typeof console&&console.log("PGBridge: WARNING: javascript handler threw.",b,g)}}})}function i(a){console.log("PGJsSDK call _handleMessageFromObjC"),m?m.push(a):h(a)}var k,l,m,n,o,p,q,r,s,j={versions:function(){var a=navigator.userAgent;return{trident:-1<a.indexOf("Trident"),presto:-1<a.indexOf("Presto"),webKit:-1<a.indexOf("AppleWebKit"),gecko:-1<a.indexOf("Gecko")&&-1==a.indexOf("KHTML"),mobile:!!a.match(/AppleWebKit.*Mobile.*/)||!!a.match(/AppleWebKit/),ios:!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<a.indexOf("Android")||-1<a.indexOf("Linux"),iPhone:-1<a.indexOf("iPhone")||-1<a.indexOf("Mac"),iPad:-1<a.indexOf("iPad"),webApp:-1==a.indexOf("Safari")}}()};window.WebViewJavascriptBridge||(l=[],m=[],n={},o={},p=1,q=null,priviteKey={},window.WebViewJavascriptBridge={init:b,send:c,registerHandler:d,callHandler:e,_fetchQueue:g,_handleMessageFromObjC:i,_handleWebShare:function(a){if(!a)throw Error("param needed in _handleWebShare");console.log("PGJsSDK call _handleWebShare"),q&&q._invokeWebShare.call(priviteKey,a)}},r=document,j.versions.ios&&a(r),s=r.createEvent("Events"),s.initEvent("PGJsSDK"),s.bridge=WebViewJavascriptBridge,s.priviteKey=priviteKey,r.dispatchEvent(s))}(),function(){function a(a){$.ajax({url:"http://activity-ktv.camera360.com:3000",type:"GET",dataType:"json",data:{data:a}}).done(function(){}).fail(function(){})}function b(a){d.server.getTicket(a,{url:window.location.href},function(a){200==a.status?(a=a.data,wx.config({debug:!1,appId:a.appid,timestamp:a.timestamp,nonceStr:a.noncestr,signature:a.sha1Str,jsApiList:"checkJsApi onMenuShareTimeline onMenuShareAppMessage onMenuShareQQ onMenuShareWeibo hideMenuItems showMenuItems hideAllNonBaseMenuItem showAllNonBaseMenuItem translateVoice startRecord stopRecord onRecordEnd playVoice pauseVoice stopVoice uploadVoice downloadVoice chooseImage previewImage uploadImage downloadImage getNetworkType openLocation getLocation hideOptionMenu showOptionMenu closeWindow scanQRCode chooseWXPay openProductSpecificView addCard chooseCard openCard".split(" ")})):d.log("获取票据失败")}),wx.error(function(a){"function not exist"==a.errMsg?d.log("微信提示：请更新最新版本"):d.log(a)})}function c(){return"wx"==d.config.channel.toLowerCase()}var d,e,f;window.PG={},d=window.PG,e={},d.config={mode:"dev",channel:"wx",appName:"",WXRegisterUrl:"http://activity.camera360.com/wechat/oauth/GetSha1Str",debug:!1},d.log=function(b){this.config.debug&&"dev"==this.config.mode&&a(b)},d.setConfig=function(a){if(!(a instanceof Object))throw Error("setConfig 参数必须是对象");for(var b in a)this.config[b]=a[b]},d.getConfig=function(){return this.config},f=null,d.ready=function(){return new d.Promise(function(a){c()?(b(d.config.WXRegisterUrl),wx.ready(function(){a&&a(e)})):window.setTimeout(function(){window.PGNative.ready(function(b){f=b,a&&a(e)})},0),d.server.statistics({type:"visit_home"},function(){})})},e.checkJsApi=function(a){return new d.Promise(function(b){c()?wx.checkJsApi({jsApiList:a.jsApiList,success:function(a){b&&b({status:200,message:"ok",checkResult:a.checkResult})}}):f.checkJsApi(a,b)})},e.showMenuItems=function(a){return new d.Promise(function(b){if(c())wx.showMenuItems({success:function(){b({status:200,message:"ok"})}});else{if(!a)throw Error("需要菜单列表参数");f.showMenuItems(a,b)}})},e.hideMenuItems=function(a){return new d.Promise(function(b){c()&&(a.success=function(){b({status:200,message:"ok"})},wx.hideMenuItems(a))})},e.chooseImage=function(a){return new d.Promise(function(b){if(c())wx.chooseImage({success:function(c){a instanceof Function&&1==arguments.length?a({status:200,message:"ok",localIds:c.localIds}):b({status:200,message:"ok",localIds:c.localIds})}});else{if(!a)throw Error("需要图片参数");-1<navigator.userAgent.indexOf("Android")||-1<navigator.userAgent.indexOf("Linux")?setTimeout(function(){f.chooseImage(a,b)},500):f.chooseImage(a,b)}})},e.uploadImage=function(a){return new d.Promise(function(b){c()?wx.uploadImage({localId:a.localId,isShowProgressTips:0,success:function(a){b({status:200,message:"ok",res:a})}}):f.uploadImage(a,b)})},e.downloadImage=function(a){return new d.Promise(function(b){c()?wx.downloadImage({serverId:a.url,isShowProgressTips:0,success:function(a){b({status:200,message:"ok",localId:a.localId})}}):f.downloadImage(a,b)})},e.saveImage=function(a){return new d.Promise(function(b){if(c())throw Error("微信不支持saveImage");f.saveImage(a,b)})},e.shareImage=function(a){return new d.Promise(function(b){if(c())throw Error("微信不支持shareImage");f.shareImage(a,b)})},e.onWebShareDefault=function(a){return new d.Promise(function(){if(c()){var e=null;a.success&&(e=a.success),a.success=function(a){e&&e(a),d.server.statistics({type:"share_friend"},function(){})},wx.onMenuShareAppMessage(a)}else e=null,a.success&&(e=a.success),a.callback=function(a){e&&e(a),d.server.statistics({type:"share_friend"},function(){})},f.onWebShareDefault(a)})},e.onWebShareTimeline=function(a){return new d.Promise(function(){if(c()){var e=null;a.success&&(e=a.success),a.success=function(a){e&&e(a),d.server.statistics({type:"share_circle"},function(){})},wx.onMenuShareTimeline(a)}else e=null,a.success&&(e=a.success),a.callback=function(a){e&&e(a),d.server.statistics({type:"share_circle"},function(){})},f.onWebShareTimeline(a)})},e.prompt=function(a,b){if(c())throw Error("微信不支持prompt");f.prompt(a,b)}}(),function(){window.PG.Promise=function(a){var b,c;if(!(a instanceof Function))throw Error("not a function");return b=this,this.status="pending",this.callbackArr=[],c=function(a){b.callbackArr.forEach(function(b){b(a)}),b.status="end"},a&&a(c),this},window.PG.Promise.prototype.then=function(a){if(!(a instanceof Function))throw Error("not a function");return this.callbackArr.push(a),this}}(),function(a){var b=function(){var b,d=b=null,e={};switch(arguments.length){case 0:case 1:throw Error("Missing Arguments");case 2:if(b=arguments[0],d=arguments[1],!d instanceof Function)throw Error("Invild Arguments");break;case 3:if(b=arguments[0],e=arguments[1],d=arguments[2],!d instanceof Function)throw Error("Invild Arguments")}switch(b={method:b,callback:d,serverData:e,retry:0},d="activity-test.camera360.com",a.PG.config.mode){case"dev":d="activity-test.camera360.com";break;case"qa":d="activity-qa.camera360.com";break;case"online":d="activity.camera360.com"}return d=a.location.protocol+"//"+d,b.method=a.PG.config.appName+"/"+b.method,b.server=d+("/"==d[d.length-1]?"":"/")+b.method,console.log("doAjaxRequest requesting "+b.server),console.log("doAjaxRequest requesting "+b.method+" ",b.serverData),b.t=(new Date).getTime(),c(b)},c=function(a){return $.ajax({timeout:3e4,type:"get",url:a.server,data:a.serverData,dataType:"jsonp",jsonp:"jsonpCallback",success:function(b){console.log("resp "+a.method+" COST="+((new Date).getTime()-a.t)),console.log("resp "+a.method+" ",b),a.callback&&a.callback(b)},error:function(b,d,e){console.log("resp "+a.method+" error errorThrown="+e),console.log("resp "+a.method+" error textStatus="+d),"abort"!=e&&""!=e&&(2>=a.retry?(console.log("retrying request "+a.method+" times="+a.retry),a.retry++,c(a)):a.callback({status:500,message:"请求超时"}))},statusCode:{404:function(){console.log("resp "+a.method+" statusCode 400"),a.callback({status:404,message:"没有找到"})},500:function(){console.log("resp "+a.method+" statusCode 500"),a.callback({status:500,message:"服务出错"})}}})};a.PG.server={getTicket:function(a,b,c){$.ajax({url:a,type:"GET",dataType:"jsonp",jsonp:"jsonpCallback",data:b}).done(function(a){c&&c(a)}).fail(function(){})},statistics:function(){},uploadWeixinImage:function(a,c){b("Photo/UploadWeixinImage",a,c)},uploadNativeImage:function(a,c){b("Photo/UploadNativeImage",a,c)},cutImage:function(a,c){b("Photo/CutImage",a,c)}}}(window);